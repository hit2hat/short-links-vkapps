(this["webpackJsonpshort-links-vkapps"]=this["webpackJsonpshort-links-vkapps"]||[]).push([[0],{131:function(e){e.exports=JSON.parse('{"name":"short-links-vkapps","version":"1.3.2","description":"","main":"index.js","scripts":{"start":"cross-env PORT=10888 react-scripts start","build":"react-scripts build","deploy":"gh-pages -d build"},"keywords":[],"author":"","homepage":"https://hit2hat.github.io/short-links-vkapps/","license":"MIT","devDependencies":{"cross-env":"^5.2.1","react-hot-loader":"^4.12.15","react-scripts":"^3.2.0"},"dependencies":{"@sentry/browser":"^5.7.1","@vkontakte/icons":"^1.10.2","@vkontakte/vk-connect":"^1.6.5","@vkontakte/vk-qr":"^2.0.8","@vkontakte/vkui":"^2.32.2","babel-eslint":"^10.0.3","chalk":"^2.4.2","core-js":"^3.3.2","gh-pages":"^2.1.1","prop-types":"^15.7.2","react":"^16.10.2","react-dom":"^16.10.2","vkui-navigator":"^1.3.2"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},135:function(e,t,n){e.exports=n(262)},259:function(e,t,n){},262:function(e,t,n){"use strict";n.r(t);n(136),n(163),n(165),n(166),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205);var a=n(0),r=n.n(a),l=n(65),o=n.n(l),c=n(24),i=n.n(c),s=n(267),u=n(23),m=n(69),d=n(117),p=n(134),h=n(44),f=n(67),g=n.n(f),k=n(85),v=n.n(k),b=n(87),E=n.n(b),y=n(51),w=n.n(y),O=n(48),_=n.n(O),P=n(68),j=n.n(P),x=n(43),S=n.n(x),C=n(126),A=n.n(C),L=n(119),I=n.n(L),M=n(125),D=n.n(M),K=n(120),T=n.n(K),z=n(121),R=n.n(z),V=n(122),W=n.n(V),B=n(123),q=n.n(B),J=n(124),N=n.n(J),U=n(50),F=n.n(U),G=n(118),H=n.n(G),Q=n(66),X=n.n(Q);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){console.log("Checking link");try{return new URL(e),console.log("Checked: true"),!0}catch(t){return console.log("Checked: false"),!1}},ee=function(e){var t=e.id,n=e.navigator,l=Object(a.useState)(null),o=Object(h.a)(l,2),c=o[0],s=o[1],u=Object(a.useState)([]),m=Object(h.a)(u,2),d=m[0],f=m[1],k=Object(a.useState)(!1),b=Object(h.a)(k,2),y=b[0],O=b[1],P=Object(a.useState)(!1),x=Object(h.a)(P,2),C=x[0],L=x[1],M=Object(a.useState)(""),K=Object(h.a)(M,2),z=K[0],V=K[1],B=Object(a.useState)(!1),J=Object(h.a)(B,2),U=J[0],G=J[1],Q=Object(a.useState)(null),Y=Object(h.a)(Q,2),ee=Y[0],te=Y[1];Object(a.useEffect)((function(){if(!1===window.is_app_user)n.goPage("welcome");else if(window.access_token)s(window.access_token),ne(window.access_token);else{(function e(){return new Promise((function(t){i.a.sendPromise("VKWebAppGetAuthToken",{app_id:7172940,scope:""}).then((function(e){return t(e.access_token)})).catch((function(){return e()}))}))})().then((function(e){s(e),ne(e)}))}}),[]);var ne=function(e){O(!1),i.a.sendPromise("VKWebAppCallAPIMethod",{method:"utils.getLastShortenedLinks",params:{count:"50",v:"5.102",access_token:e}}).then((function(e){return f(e.response.items)})).finally((function(){return O(!0)}))},ae=function(e){i.a.sendPromise("VKWebAppCallAPIMethod",{method:"utils.deleteFromLastShortened",params:{key:e,v:"5.102",access_token:c}}).then((function(){return f(d.filter((function(t){return t.key!==e})))})).catch((function(e){return console.error(JSON.stringify(e))}))};return r.a.createElement(g.a,{id:t},r.a.createElement(v.a,null,"\u041a\u043e\u0440\u043e\u0442\u043a\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"),r.a.createElement(I.a,{onRefresh:function(){return ne(c)},isFetching:!y},r.a.createElement(E.a,{title:"\u0421\u043e\u043a\u0440\u0430\u0442\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"},r.a.createElement(T.a,null,r.a.createElement(R.a,null,ee&&r.a.createElement(W.a,{state:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430",children:ee}),r.a.createElement(q.a,{placeholder:"\u0412\u0430\u0448\u0430 \u0441\u0441\u044b\u043b\u043a\u0430",value:z,onChange:function(e){return z.length<255?V(e.currentTarget.value):null}}),r.a.createElement(N.a,{style:{marginTop:10},value:U,onChange:function(){return G(!U)}},"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0432\u0438\u0434\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043c\u043d\u0435")),r.a.createElement(S.a,{size:"xl",onClick:function(){!function(e,t){if(console.log("Try to add link "+e),!C){if(te(null),0===e.length)return console.log("Link was small. Exit"),te("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443");if(!$(e)){if(!$("https://"+e))return console.log("Link is not link :D"),te("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u0442\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430");e="https://"+e}console.log("OK. Send request"),L(!0),n.showLoader(),i.a.sendPromise("VKWebAppCallAPIMethod",{method:"utils.getShortLink",params:{url:e,private:t?"1":"0",v:"5.102",access_token:c}}).then((function(e){console.log("Request success. Adding..."),-1===d.findIndex((function(t){return t.key===e.response.key}))?(f([Z({},e.response,{timestamp:Math.floor(Date.now()/1e3),views:0})].concat(Object(p.a)(d))),V("")):(console.log("List is exist"),te("\u0421\u0441\u044b\u043b\u043a\u0430 \u0443\u0436\u0435 \u0441\u043e\u043a\u0440\u0430\u0449\u0435\u043d\u0430")),console.log("Hide loader"),n.hideLoader(),L(!1)})).catch((function(){console.log("Request failed"),te("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443"),console.log("Hide loader"),n.hideLoader(),L(!1)}))}}(z,U)},style:{cursor:"pointer"}},"\u0421\u043e\u043a\u0440\u0430\u0442\u0438\u0442\u044c"))),r.a.createElement(E.a,{title:"\u041c\u043e\u0438 \u0441\u0441\u044b\u043b\u043a\u0438"},y?d.length>0?r.a.createElement(j.a,null,d.map((function(e){return r.a.createElement(_.a,{expandable:!0,key:e.key,before:r.a.createElement(w.a,{type:"app",style:{background:"var(--accent)"},size:40},r.a.createElement(F.a,{fill:"white"})),children:r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement("span",{style:{marginRight:3}},e.short_url),e.access_key?r.a.createElement(X.a,{fill:"var(--text_secondary)"}):null),indicator:r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(H.a,{fill:"var(--text_secondary)"}),r.a.createElement("span",{style:{marginLeft:3}},(t=e.views,t<1e3?t:t<1e6?Math.floor(t/1e3*10)/10+"K":Math.floor(t/1e6*10)/10+"M"))),description:e.url.slice(0,28)+(e.url.length>28?"...":""),onClick:function(){return n.showModal("link-info",{link:e,deleteLink:ae})}});var t}))):r.a.createElement(D.a,{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u0441\u044b\u043b\u043e\u043a \u043f\u0443\u0441\u0442",children:"\u0421\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u044f\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u0432 \u044d\u0442\u043e\u0439 \u0441\u0435\u043a\u0446\u0438\u0438"}):r.a.createElement("div",{style:{paddingBottom:25}},r.a.createElement(A.a,null)))))},te=function(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.dispatchEvent(new window.MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))},ne=n(130),ae=n.n(ne),re=n(52),le=n.n(re),oe=n(127),ce=n.n(oe),ie=n(128),se=n.n(ie),ue=n(129),me=n.n(ue),de=function(e){var t=e.id,n=e.onClose,a=e.header,l=e.navigator,o=l.params.link||{},c=l.params.deleteLink||null;return r.a.createElement(ae.a,{id:t,onClose:n,header:a},r.a.createElement(le.a,{style:{display:"flex",alignItems:"center",flexDirection:"column"}},r.a.createElement(w.a,{type:"image",size:60,style:{background:"var(--accent)"}},r.a.createElement(F.a,{fill:"white"})),r.a.createElement("h1",{style:{marginTop:10,marginBottom:0,fontSize:18,display:"flex",alignItems:"center"}},r.a.createElement("span",{style:{margin:0,padding:0,marginRight:3}},o.key),o.access_key?r.a.createElement(X.a,{fill:"var(--text_secondary)"}):null),r.a.createElement("h3",{style:{marginTop:5,marginBottom:0,fontSize:14,color:"var(--text_secondary)"}},o.short_url)),r.a.createElement(le.a,null,r.a.createElement("div",{style:{display:"flex",marginBottom:25}},r.a.createElement(S.a,{before:r.a.createElement(se.a,null),size:"l",stretched:!0,onClick:function(){return i.a.send("VKWebAppShare",{link:o.short_url})},style:{cursor:"pointer",marginRight:10}},"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"),r.a.createElement(S.a,{before:r.a.createElement(me.a,null),level:"destructive",size:"l",stretched:!0,onClick:function(){c(o.key),l.hideModal()},style:{cursor:"pointer"}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")),r.a.createElement(j.a,null,r.a.createElement(_.a,{children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e",indicator:new Date(1e3*o.timestamp).toLocaleString()}),r.a.createElement(_.a,{children:"\u041e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430",onClick:function(){return te(o.url)},indicator:r.a.createElement(S.a,{before:r.a.createElement(ce.a,null)},"\u041e\u0442\u043a\u0440\u044b\u0442\u044c")}),r.a.createElement(_.a,{children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430",indicator:o.access_key?"\u041f\u0440\u0438\u0432\u0430\u0442\u043d\u0430\u044f":"\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u0430\u044f"}),r.a.createElement(_.a,{children:"\u041f\u0435\u0440\u0435\u0445\u043e\u0434\u044b",indicator:o.views}))))},pe=n(86),he=n.n(pe),fe=function(e){var t=e.id,n=e.navigator;return r.a.createElement(g.a,{id:t,theme:"white",centered:!0},r.a.createElement(le.a,{style:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center"}},r.a.createElement(w.a,{type:"app",size:60,style:{background:"var(--accent)"}},r.a.createElement(F.a,{fill:"white"})),r.a.createElement("h1",{style:{marginBottom:0}},"\u041a\u043e\u0440\u043e\u0442\u043a\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"),r.a.createElement("p",{style:{marginTop:15,marginBottom:5}},"\u0412 \u044d\u0442\u043e\u043c \u0441\u0435\u0440\u0432\u0438\u0441\u0435 \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0438\u0437 \u0434\u043b\u0438\u043d\u043d\u043e\u0439 \u0438 \u0441\u043b\u043e\u0436\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u043f\u0440\u043e\u0441\u0442\u0443\u044e. \u0422\u0430\u043a\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0443\u0434\u043e\u0431\u043d\u0435\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432 \u0412\u0430\u0448\u0438\u0445 \u0437\u0430\u043f\u0438\u0441\u044f\u0445 \u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u0445.")),r.a.createElement(he.a,{vertical:"bottom"},r.a.createElement(le.a,null,r.a.createElement(S.a,{size:"xl",style:{cursor:"pointer"},onClick:function(){i.a.sendPromise("VKWebAppGetAuthToken",{app_id:7172940,scope:""}).then((function(e){window.is_app_user=!0,window.access_token=e.access_token,n.goPage("main")}))}},"\u041d\u0430\u0447\u0430\u0442\u044c"))))},ge=function(){return r.a.createElement(m.Stack,{activePage:"main",modals:[r.a.createElement(de,{id:"link-info",title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0441\u044b\u043b\u043a\u0435"})]},r.a.createElement(m.Page,{id:"main",activePanel:"home"},r.a.createElement(ee,{id:"home"})),r.a.createElement(m.Page,{id:"welcome",activePanel:"welcome"},r.a.createElement(fe,{id:"welcome"})))},ke=n(131);n(258),n(259);s.a({dsn:"https://6c2fd3ebb2d34f2fb50651894a8e6292@sentry.io/1788338",release:ke.version,environment:"production"});var ve=new URL(window.location.href);u.b({id:ve.searchParams&&ve.searchParams.get("vk_user_id"),platform:ve.searchParams&&ve.searchParams.get("vk_platform")}),window.is_app_user=-1!==["localhost:10888","192.168.1.141:10888"].indexOf(ve.host)||ve.searchParams&&"1"===ve.searchParams.get("vk_is_app_user"),i.a.send("VKWebAppInit"),i.a.subscribe((function(e){var t=e.detail,n=t.type,a=t.data;if("VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value=a.scheme?a.scheme:"bright_light",document.body.attributes.setNamedItem(r)}})),o.a.render(r.a.createElement(ge,null),document.getElementById("root"))}},[[135,1,2]]]);
//# sourceMappingURL=main.9bc34899.chunk.js.map